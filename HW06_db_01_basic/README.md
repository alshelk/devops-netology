# Домашнее задание к занятию 6.1. "Типы и структура СУБД"

## Задача 1

Архитектор ПО решил проконсультироваться у вас, какой тип БД 
лучше выбрать для хранения определенных данных.

Он вам предоставил следующие типы сущностей, которые нужно будет хранить в БД:

- Электронные чеки в json виде

    
    Документоориентрованные базы данных (Например, MongoDB). Т.к. мы заранее не знаем схему данных 
    (т.е. чеки могут сильно отличаться друг от друга как по количеству полей, так и по-содержимому), 
    то mongodb отличное решение для кассовых чеков.
        

- Склады и автомобильные дороги для логистической компании


    Графовые базы данных (такие, как Neo4j или OrientDB). В виде графов можно представить 
    склады (вершины) и дороги между ними (ребра). Для таких баз является типичной задачей нахождение
    кратчайшего маршрута между складами путем обхода графа.

- Генеалогические деревья


    Графовые базы данных. В виде вершин выступают люди, а ребра - это родственные связи между людьми.
    (Также возможны сетевые базы данных как частный случай графовых.)


- Кэш идентификаторов клиентов с ограниченным временем жизни для движка аутентификации


    Базы ключ-значение такие, как Redis и Memcached. Эти базы позволяют быстро записывать, менять и получать значения 
    по какому-то параметру. Они часто используется для некритичны, часто меняющихся значений, которые нет смысла
    хранить и для построения кеш-систем.

- Отношения клиент-покупка для интернет-магазина

    
    Я бы выбрал документоориентированные бд. Нам заранее не известно ни количество покупок, не их содержимое.
    Но возможно подойдет и Column-oriented бд, если нам не важна скорость записи. Такие бд в основном используются
    для веб-индексирования и задач связанных с большими данными (т.к. благодаря сжатию будут занимать в несколько 
    раз меньше места в сравнении с традиционными), так же для построения отчетностей и аналитических систем ввиду 
    быстрой скорости выполнения операций на чтение.

Выберите подходящие типы СУБД для каждой сущности и объясните свой выбор.

## Задача 2

Вы создали распределенное высоко нагруженное приложение и хотите классифицировать его согласно 
CAP-теореме. Какой классификации по CAP-теореме соответствует ваша система, если 
(каждый пункт - это отдельная реализация вашей системы и для каждого пункта надо привести классификацию):

- Данные записываются на все узлы с задержкой до часа (асинхронная запись)


    CA (availability + consistency – partition tolerance) — когда данные во всех узлах кластера 
    согласованы и доступны, но неустойчивы к разделению.
    В условии ничего не сказано про возможности разделение, и про работу в отсутствии связи между узлами.


- При сетевых сбоях, система может разделиться на 2 раздельных кластера


    AP (availability + partition tolerance – consistency) — не гарантирует целостность данных, обеспечивая их 
    доступность и устойчивость к разделению.
    Система может разделиться и оставаться доступной, но согласованность данных не гарантируется

- Система может не прислать корректный ответ или сбросить соединение


    CP (consistency + partition tolerance – availability) в каждый момент обеспечивает целостность данных и 
    способна работать в условиях распада в ущерб доступности.
    Доступность не гарантируется условием, значит следуя CAP теореме, остаются 
    согласованность данных и устойчивость к разделению.

А согласно PACELC-теореме, как бы вы классифицировали данные реализации?

- Данные записываются на все узлы с задержкой до часа (асинхронная запись)


    - PA/EC  доступность со ставкой на целостность 
    или PC/EL  разделении стремится оставаться консистентной, а в случае без сетевых разделений, фокусируется на скорости ответа
    или PC/EC  с большой долей вероятности будут жертвовать доступностью в угоду консистентности
 
- При сетевых сбоях, система может разделиться на 2 раздельных кластера


    - PA/EL  высокая доступность при разделении системы иначе высокая скорость ответа 
    или PA/EC  доступность со ставкой на целостность
 
- Система может не прислать корректный ответ или сбросить соединение


    - PC/EL при разделении стремится оставаться консистентной, а в случае без сетевых разделений, фокусируется на скорости ответа
    или PC/EC жертвуем доступностью в угоду консистентности 

## Задача 3

Могут ли в одной системе сочетаться принципы BASE и ACID? Почему?

    Нет не могут. Принципы BASE противоречат принципам ACID.
    ACID может провести только допустимые транзакции, и гарантирует согласованность данных.
    BASE допускает что неверные данные могут быть возвращены (отменены).
    
## Задача 4

Вам дали задачу написать системное решение, основой которого бы послужили:

- фиксация некоторых значений с временем жизни
- реакция на истечение таймаута

Вы слышали о key-value хранилище, которое имеет механизм Pub/Sub. 
Что это за система? Какие минусы выбора данной системы?

    Redis Pub/Sub — простая система сообщений, уже встроенная в key-value хранилище


    Недостатки Redis Pub/Sub:
    - Если издатель по каким-либо причинам выходит из строя, то он теряет всех своих подписчиков
    - Издателю необходимо знать точный адрес всех его подписчиков
    - Издатель может перегрузить работой своих подписчиков, если данные публикуются быстрее, чем обрабатываются
    - Сообщение удаляется из буфера издателя сразу после публикации, не зависимо от того, какому числу подписчиков 
    оно доставлено и как быстро те сумели обработать это сообщение.
    - Все подписчики получат сообщение одновременно. Подписчики сами должны как-то между собой согласовывать 
    порядок обработки одного и того же сообщения.
    - Нет встроенного механизма подтверждения успешной обработки сообщения подписчиком. Если подписчик получил 
    сообщение и свалился во время обработки, то издатель об этом не узнает.

---
